---
title: Netty
---



## Netty介绍

Netty是一个Java NIO技术的开源异步事件驱动的网络编程框架，用于快速开发可维护的高性能协议服务器和客户端。

往通俗了讲，可以将Netty理解为：一个将Java NIO进行了大量封装，并大大降低Java NIO使用难度和上手门槛的超牛逼框架。



## 基本常识

在了解Netty之前，我们非常有必要简要了解一下Java网络编程模型的基本常识，具体说也就是BIO、NIO和AIO这3个技术概念。

**BIO、NIO和AIO这三个概念分别对应三种通讯模型：**阻塞、非阻塞、非阻塞异步，具体这里就不详细写了。网上好多博客说Netty对应NIO，准确来说，应该是既可以是NIO，也可以是AIO，就看你怎么实现。

**这三个概念的区别如下：**

1）BIO：一个连接一个线程，客户端有连接请求时服务器端就需要启动一个线程进行处理,线程开销大。

2）NIO：一个请求一个线程，客户端发送的连接请求会注册到多路复用器上，多路复用器轮询到该连接有I/O请求时才启动一个线程进行处理；

3）AIO：一个有效请求一个线程，客户端的I/O请求都是由OS先完成了再通知服务器应用去启动线程进行处理。

**通俗地概括一下就是：**

> 1）BIO是面向流的，NIO是面向缓冲区的；
>
> 2）BIO的各种流是阻塞的，而NIO是非阻塞的；
>
> 3）BIO的Stream是单向的，而NIO的channel是双向的。

| BIO是面向流的，阻塞的                                        |
| ------------------------------------------------------------ |
| ![](https://qfedu-1254123199.cos.ap-nanjing.myqcloud.com/img/202206151002591.jpeg) |
| NIO是面向缓冲区的，非阻塞的                                  |
| ![](https://qfedu-1254123199.cos.ap-nanjing.myqcloud.com/img/202206151002313.jpeg) |



**NIO的的显著特点：**事件驱动模型、单线程处理多任务、非阻塞I/O，I/O读写不再阻塞，而是返回基于block的传输比基于流的传输更高效、更高级的IO函数zero-copy、IO多路复用大大提高了Java网络应用的可伸缩性和实用性。基于Reactor线程模型。



## 技术特征

**Netty的优点，概括一下就是：**

1）使用简单；

2）功能强大；

3）性能强悍。

**Netty的特点：**

1）高并发：基于 NIO（Nonblocking IO，非阻塞IO）开发，对比于 BIO（Blocking I/O，阻塞IO），他的并发性能得到了很大提高；

2）传输快：传输依赖于零拷贝特性，尽量减少不必要的内存拷贝，实现了更高效率的传输；

3）封装好：封装了 NIO 操作的很多细节，提供了易于使用调用接口。

**Netty的优势：**

1）使用简单：封装了 NIO 的很多细节，使用更简单；

2）功能强大：预置了多种编解码功能，支持多种主流协议；

3）扩展性强：可以通过 ChannelHandler 对通信框架进行灵活地扩展；

4）性能优异：通过与其他业界主流的 NIO 框架对比，Netty 的综合性能最优；

5）运行稳定：Netty 修复了已经发现的所有 NIO 的 bug，让开发人员可以专注于业务本身；

6）社区活跃：Netty 是活跃的开源项目，版本迭代周期短，bug 修复速度快。

**Netty高性能表现在哪些方面？**

1）IO 线程模型：同步非阻塞，用最少的资源做更多的事；

2）内存零拷贝：尽量减少不必要的内存拷贝，实现了更高效率的传输；

3）内存池设计：申请的内存可以重用，主要指直接内存。内部实现是用一颗二叉查找树管理内存分配情况；

4）串形化处理读写：避免使用锁带来的性能开销；

5）高性能序列化协议：支持 protobuf 等高性能序列化协议。



## Netty作者

Netty的创始人是韩国人Trustin Lee，80年出生，8岁起在MSX迷你计算机上编写BASIC程序，爱好游戏编程以及使用汇编、C和C++解决编程问题，1998年获得韩国信息奥林匹克竞赛铜牌。

就读于韩国Yonsei大学计算机系期间，曾为多家公司编写高性能网络应用以及少量的web程序，毕业后，就职于Arreo通讯公司，该公司为韩国最大的移动短信提供商之一。



## Netty能做什么？

学技能都是为了能够应用到实际工作中去，谁也不是为了学而学、弄着玩不是，那么Netty能做什么呢？

主要是在两个方面。

**一方面：**现在物联网的应用无处不在，大量的项目都牵涉到应用传感器和服务器端的数据通信，Netty作为基础通信组件、能够轻松解决之前有较高门槛的通信系统开发，你不用再为如何解析各类简单、或复杂的通讯协议而薅头发了，有过这方面开发经验的程序员会有更深刻、或者说刻骨铭心的体会。

**另一方面：**现在互联网系统讲究的都是高并发、分布式、微服务，各类消息满天飞（是的，IM系统、消息推送系统就是其中的典型），Netty在这类架构里面的应用可谓是如鱼得水，如果你对当前的各种应用服务器不爽，那么完全可以基于Netty来实现自己的HTTP服务器、FTP服务器、UDP服务器、RPC服务器、WebSocket服务器、Redis的Proxy服务器、MySQL的Proxy服务器等等。



## 掌握Netty有什么好处？

**直接的好处是：**能够有进大厂、拿高薪的机会，业内好多著名的公司在招聘高级/资深Java工程师时基本上都要求熟练掌握、或熟悉Netty。

![img](https://qfedu-1254123199.cos.ap-nanjing.myqcloud.com/img/202206150010848.png)



这个名单还可以很长很长。。。

作为一个学Java的，如果没有研究过Netty，那么你对Java语言的使用和理解仅仅停留在表面水平，会点SSH，写几个MVC，访问数据库和缓存，这些只是初、中等Java程序员干的事。如果你要进阶，想了解Java服务器的深层高阶知识，Netty绝对是一个必须要过的门槛。

**间接地好处是：**多款开源框架中应用了Netty，掌握了Netty，就具有分析这些开源框架的基础了，也就是有了成为技术大牛的基础。

这些开源框架有哪些呢？

**简单罗列一些典型的，如下：**

1）阿里分布式服务框架 Dubbo 的 RPC 框架；

2）淘宝的消息中间件 RocketMQ；

3）Hadoop 的高性能通信和序列化组件 Avro 的 RPC 框架；

4）开源集群运算框架 Spark；

5）分布式计算框架 Storm；

6）并发应用和分布式应用 Akka；

7）名单依然很长很长。。。。



## Netty的主要组件及概念

| 核心组件           | 概念                                                         |
| ------------------ | ------------------------------------------------------------ |
| I/O                | 各种各样的流（文件、数组、缓冲、管道。。。）的处理（输入输出） |
| Channel            | 通道，代表一个连接，每个Client请对会对应到具体的一个Channel  |
| ChannelPipeline    | 责任链，每个Channel都有且仅有一个ChannelPipeline与之对应，里面是各种各样的Handler |
| handler            | 用于处理出入站消息及相应的事件，实现我们自己要的业务逻辑     |
| EventLoopGroup     | I/O线程池，负责处理Channel对应的I/O事件                      |
| ServerBootstrap    | 服务器端启动辅助对象                                         |
| Bootstrap          | 客户端启动辅助对象                                           |
| ChannelInitializer | Channel初始化器                                              |
| ChannelFuture      | 代表I/O操作的执行结果，通过事件机制，获取执行结果，通过添加监听器，执行我们想要的操作 |
| ByteBuf            | 字节序列，通过ByteBuf操作基础的字节数组和缓冲区              |

